=== Fine-Grained Scaling Characterization ===
Starting fine-grained scaling characterization...
Device: cuda
Loading Geneformer components...
Loading Geneformer model...
Model loaded: 18L x 18H
Loading immune dataset: /mnt/d/openclaw/mechinterp-bio/biodyn-work/single_cell_mechinterp/data/raw/tabula_sapiens_immune_subset_20000.h5ad
Dataset shape: (20000, 60606)
Cell types: cell_type
B cell                             3762
CD4-positive, alpha-beta T cell    3373
CD8-positive, alpha-beta T cell    2547
neutrophil                         2455
macrophage                         2277
Name: count, dtype: int64
Loading TRRUST...
TRRUST: 8330 edges
Pre-filtering dataset...
After filtering: (20000, 34293)
Will test cell counts: [25, 50, 100, 150, 200, 300, 500, 750, 1000]
Setting up gene vocabulary...
Using 1000 top genes

============================================================
SCALING CHARACTERIZATION EXPERIMENT
============================================================

--- Testing 25 cells ---
  Repeat 1/2...
    Sampled 25 cells
    Cell types: {'T cell': 1, 'erythroid progenitor cell': 1, 'classical monocyte': 1, 'CD4-positive, alpha-beta T cell': 3, 'leukocyte': 1, 'common myeloid progenitor': 1, 'colon macrophage': 1, 'neutrophil': 3, 'gamma-delta T cell': 1, 'B cell': 1, 'naive thymus-derived CD8-positive, alpha-beta T cell': 1, 'CD8-positive, alpha-beta T cell': 2, 'tissue-resident macrophage': 1, 'innate lymphoid cell': 1, 'mast cell': 1, 'non-classical monocyte': 1, 'myeloid leukocyte': 1, 'hematopoietic cell': 1, 'activated CD4-positive, alpha-beta T cell': 1, 'Langerhans cell': 1}
    Valid cells with >10 tokens: 25
    Extracting attention from layer 13...
    Evaluating AUROC with bootstrap...
    AUROC: 0.5268 [0.5059, 0.5538] (161 pos edges)
  Repeat 2/2...
    Sampled 25 cells
    Cell types: {'mononuclear phagocyte': 1, 'hematopoietic precursor cell': 1, 'CD4-positive, alpha-beta T cell': 2, 'Langerhans cell': 1, 'CD8-positive, alpha-beta thymocyte': 1, 'mature NK T cell': 1, 'CD8-positive, alpha-beta T cell': 2, 'tissue-resident macrophage': 1, 'macrophage': 2, 'natural killer cell': 1, 'classical monocyte': 1, 'B cell': 1, 'hematopoietic stem cell': 1, 'gamma-delta T cell': 1, 'erythrocyte': 1, 'erythroid progenitor cell': 1, 'microglial cell': 1, 'hematopoietic cell': 1, 'T cell': 1, 'non-classical monocyte': 1, 'basophil': 1, 'intermediate monocyte': 1}
    Valid cells with >10 tokens: 25
    Extracting attention from layer 13...
    Evaluating AUROC with bootstrap...
    AUROC: 0.5449 [0.5230, 0.5758] (161 pos edges)
  Summary for 25 cells:
    Mean AUROC: 0.5359 ± 0.0091
    Mean CI: [0.5144, 0.5648]

--- Testing 50 cells ---
  Repeat 1/2...
    Sampled 50 cells
    Cell types: {'granulocyte': 1, 'CD4-positive, alpha-beta T cell': 5, 'macrophage': 4, 'CD8-positive, alpha-beta T cell': 3, 'naive thymus-derived CD4-positive, alpha-beta T cell': 1, 'basophil': 1, 'neutrophil': 5, 'innate lymphoid cell': 1, 'leukocyte': 1, 'non-classical monocyte': 1, 'monocyte': 1, 'plasma cell': 1, 'gamma-delta T cell': 1, 'hematopoietic precursor cell': 1, 'B cell': 7, 'microglial cell': 1, 'common myeloid progenitor': 1, 'myeloid dendritic cell': 1, 'naive thymus-derived CD8-positive, alpha-beta T cell': 1, 'T cell': 1, 'activated CD4-positive, alpha-beta T cell': 1, 'thymocyte': 1, 'natural killer cell': 1, 'erythroid progenitor cell': 1, 'hematopoietic cell': 1, 'mast cell': 1, 'mononuclear phagocyte': 1, 'Langerhans cell': 1, 'tissue-resident macrophage': 1, 'CD4-positive, alpha-beta thymocyte': 1, 'hematopoietic stem cell': 1}
    Valid cells with >10 tokens: 50
    Extracting attention from layer 13...
    Evaluating AUROC with bootstrap...
    AUROC: 0.5357 [0.5143, 0.5629] (161 pos edges)
  Repeat 2/2...
    Sampled 50 cells
    Cell types: {'B cell': 7, 'CD4-positive, alpha-beta T cell': 6, 'macrophage': 4, 'natural killer cell': 1, 'plasma cell': 2, 'platelet': 1, 'naive thymus-derived CD4-positive, alpha-beta T cell': 1, 'neutrophil': 4, 'intermediate monocyte': 1, 'colon macrophage': 1, 'myeloid cell': 1, 'erythroid progenitor cell': 1, 'classical monocyte': 1, 'CD8-positive, alpha-beta T cell': 5, 'activated CD8-positive, alpha-beta T cell': 1, 'myeloid dendritic cell': 1, 'hematopoietic cell': 1, 'hematopoietic precursor cell': 1, 'innate lymphoid cell': 1, 'plasmacytoid dendritic cell': 1, 'myeloid leukocyte': 1, 'hematopoietic stem cell': 1, 'activated CD4-positive, alpha-beta T cell': 1, 'mononuclear phagocyte': 1, 'mast cell': 1, 'erythrocyte': 1, 'leukocyte': 1, 'gamma-delta T cell': 1}
    Valid cells with >10 tokens: 50
    Extracting attention from layer 13...
    Evaluating AUROC with bootstrap...
    AUROC: 0.5482 [0.5201, 0.5996] (161 pos edges)
  Summary for 50 cells:
    Mean AUROC: 0.5419 ± 0.0062
    Mean CI: [0.5172, 0.5813]

--- Testing 100 cells ---
  Repeat 1/2...
    Sampled 100 cells
    Cell types: {'erythrocyte': 1, 'CD8-positive, alpha-beta T cell': 12, 'natural killer cell': 2, 'macrophage': 10, 'myeloid cell': 1, 'CD4-positive, alpha-beta T cell': 12, 'neutrophil': 8, 'platelet': 1, 'thymocyte': 1, 'CD4-positive, alpha-beta thymocyte': 1, 'activated CD4-positive, alpha-beta T cell': 1, 'tissue-resident macrophage': 1, 'hematopoietic stem cell': 1, 'B cell': 16, 'innate lymphoid cell': 1, 'classical monocyte': 3, 'plasma cell': 4, 'myeloid leukocyte': 1, 'mononuclear phagocyte': 1, 'basophil': 1, 'plasmacytoid dendritic cell': 1, 'erythroid progenitor cell': 1, 'common myeloid progenitor': 1, 'naive thymus-derived CD8-positive, alpha-beta T cell': 1, 'T cell': 1, 'naive thymus-derived CD4-positive, alpha-beta T cell': 1, 'Langerhans cell': 1, 'intermediate monocyte': 1, 'monocyte': 3, 'non-classical monocyte': 1, 'granulocyte': 1, 'colon macrophage': 1, 'regulatory T cell': 1, 'microglial cell': 1, 'mast cell': 1, 'mature NK T cell': 1, 'leukocyte': 1, 'myeloid dendritic cell': 1, 'activated CD8-positive, alpha-beta T cell': 1}
    Valid cells with >10 tokens: 100
    Extracting attention from layer 13...
    Evaluating AUROC with bootstrap...
    AUROC: 0.5456 [0.5164, 0.5913] (161 pos edges)
  Repeat 2/2...
    Sampled 100 cells
    Cell types: {'CD4-positive, alpha-beta T cell': 15, 'common myeloid progenitor': 1, 'CD8-positive, alpha-beta T cell': 8, 'natural killer cell': 2, 'plasma cell': 4, 'mast cell': 1, 'macrophage': 10, 'myeloid cell': 1, 'B cell': 14, 'microglial cell': 1, 'tissue-resident macrophage': 1, 'Langerhans cell': 1, 'neutrophil': 10, 'hematopoietic stem cell': 1, 'classical monocyte': 3, 'T cell': 1, 'naive thymus-derived CD4-positive, alpha-beta T cell': 1, 'monocyte': 4, 'CD8-positive, alpha-beta thymocyte': 1, 'non-classical monocyte': 1, 'granulocyte': 1, 'thymocyte': 1, 'leukocyte': 1, 'myeloid leukocyte': 1, 'platelet': 1, 'mononuclear phagocyte': 1, 'hematopoietic cell': 1, 'regulatory T cell': 1, 'CD4-positive, alpha-beta thymocyte': 1, 'gamma-delta T cell': 1, 'activated CD8-positive, alpha-beta T cell': 1, 'activated CD4-positive, alpha-beta T cell': 1, 'mature NK T cell': 1, 'naive thymus-derived CD8-positive, alpha-beta T cell': 1, 'innate lymphoid cell': 1, 'myeloid dendritic cell': 1, 'erythrocyte': 1, 'basophil': 1, 'erythroid progenitor cell': 1}
    Valid cells with >10 tokens: 100
    Extracting attention from layer 13...
    Evaluating AUROC with bootstrap...
    AUROC: 0.5434 [0.5200, 0.5971] (161 pos edges)
  Summary for 100 cells:
    Mean AUROC: 0.5445 ± 0.0011
    Mean CI: [0.5182, 0.5942]

--- Testing 150 cells ---
  Repeat 1/2...
    Sampled 150 cells
    Cell types: {'B cell': 24, 'CD4-positive, alpha-beta T cell': 25, 'neutrophil': 14, 'CD4-positive, alpha-beta thymocyte': 1, 'natural killer cell': 3, 'macrophage': 17, 'granulocyte': 1, 'intermediate monocyte': 1, 'plasma cell': 6, 'CD8-positive, alpha-beta T cell': 19, 'basophil': 1, 'erythroid progenitor cell': 1, 'hematopoietic stem cell': 1, 'naive thymus-derived CD8-positive, alpha-beta T cell': 1, 'monocyte': 4, 'Langerhans cell': 1, 'myeloid leukocyte': 1, 'erythrocyte': 3, 'T cell': 1, 'common myeloid progenitor': 1, 'naive thymus-derived CD4-positive, alpha-beta T cell': 1, 'classical monocyte': 4, 'activated CD4-positive, alpha-beta T cell': 1, 'innate lymphoid cell': 1, 'gamma-delta T cell': 1, 'colon macrophage': 1, 'CD8-positive, alpha-beta thymocyte': 1, 'regulatory T cell': 1, 'microglial cell': 1, 'hematopoietic precursor cell': 1, 'mononuclear phagocyte': 1, 'mast cell': 1, 'mature NK T cell': 1, 'myeloid cell': 1, 'hematopoietic cell': 1, 'myeloid dendritic cell': 1, 'activated CD8-positive, alpha-beta T cell': 1, 'thymocyte': 1, 'leukocyte': 1, 'plasmacytoid dendritic cell': 1, 'platelet': 1}
    Valid cells with >10 tokens: 150
    Extracting attention from layer 13...
    Evaluating AUROC with bootstrap...
    AUROC: 0.5531 [0.5233, 0.5938] (161 pos edges)
  Repeat 2/2...
    Sampled 150 cells
    Cell types: {'natural killer cell': 3, 'intermediate monocyte': 1, 'macrophage': 15, 'B cell': 28, 'tissue-resident macrophage': 1, 'activated CD8-positive, alpha-beta T cell': 1, 'CD4-positive, alpha-beta T cell': 22, 'microglial cell': 1, 'CD8-positive, alpha-beta T cell': 17, 'neutrophil': 15, 'myeloid dendritic cell': 1, 'mononuclear phagocyte': 1, 'plasma cell': 6, 'granulocyte': 1, 'T cell': 1, 'non-classical monocyte': 1, 'leukocyte': 1, 'colon macrophage': 1, 'monocyte': 5, 'gamma-delta T cell': 1, 'classical monocyte': 4, 'innate lymphoid cell': 1, 'CD8-positive, alpha-beta thymocyte': 1, 'common myeloid progenitor': 1, 'myeloid cell': 1, 'CD4-positive, alpha-beta thymocyte': 1, 'myeloid leukocyte': 1, 'thymocyte': 1, 'Langerhans cell': 1, 'erythrocyte': 3, 'erythroid progenitor cell': 1, 'plasmacytoid dendritic cell': 1, 'hematopoietic stem cell': 1, 'naive thymus-derived CD8-positive, alpha-beta T cell': 1, 'naive thymus-derived CD4-positive, alpha-beta T cell': 2, 'platelet': 1, 'hematopoietic precursor cell': 1, 'mature NK T cell': 1, 'mast cell': 1, 'activated CD4-positive, alpha-beta T cell': 1, 'basophil': 1}
    Valid cells with >10 tokens: 150
    Extracting attention from layer 13...
    Evaluating AUROC with bootstrap...
    AUROC: 0.5582 [0.5185, 0.6168] (161 pos edges)
  Summary for 150 cells:
    Mean AUROC: 0.5557 ± 0.0026
    Mean CI: [0.5209, 0.6053]

--- Testing 200 cells ---
  Repeat 1/2...
    Sampled 200 cells
    Cell types: {'basophil': 1, 'plasma cell': 8, 'neutrophil': 22, 'macrophage': 20, 'innate lymphoid cell': 1, 'naive thymus-derived CD4-positive, alpha-beta T cell': 3, 'B cell': 36, 'CD8-positive, alpha-beta T cell': 24, 'CD4-positive, alpha-beta T cell': 33, 'hematopoietic cell': 1, 'monocyte': 7, 'T cell': 2, 'thymocyte': 1, 'natural killer cell': 4, 'erythrocyte': 5, 'classical monocyte': 6, 'activated CD4-positive, alpha-beta T cell': 1, 'plasmacytoid dendritic cell': 1, 'myeloid leukocyte': 1, 'colon macrophage': 1, 'granulocyte': 1, 'platelet': 1, 'activated CD8-positive, alpha-beta T cell': 1, 'mast cell': 1, 'tissue-resident macrophage': 1, 'intermediate monocyte': 1, 'leukocyte': 1, 'myeloid cell': 1, 'hematopoietic precursor cell': 1, 'regulatory T cell': 1, 'naive thymus-derived CD8-positive, alpha-beta T cell': 1, 'common myeloid progenitor': 1, 'microglial cell': 1, 'gamma-delta T cell': 1, 'mononuclear phagocyte': 1, 'non-classical monocyte': 1, 'Langerhans cell': 1, 'CD4-positive, alpha-beta thymocyte': 1, 'CD8-positive, alpha-beta thymocyte': 1, 'myeloid dendritic cell': 1, 'mature NK T cell': 1, 'erythroid progenitor cell': 1}
    Valid cells with >10 tokens: 200
    Extracting attention from layer 13...
    Evaluating AUROC with bootstrap...
    AUROC: 0.6009 [0.5618, 0.6459] (161 pos edges)
  Repeat 2/2...
    Sampled 200 cells
    Cell types: {'B cell': 35, 'CD4-positive, alpha-beta T cell': 32, 'erythrocyte': 5, 'plasma cell': 8, 'CD8-positive, alpha-beta T cell': 24, 'neutrophil': 21, 'naive thymus-derived CD4-positive, alpha-beta T cell': 3, 'natural killer cell': 4, 'monocyte': 8, 'gamma-delta T cell': 1, 'T cell': 2, 'macrophage': 20, 'mast cell': 2, 'classical monocyte': 6, 'naive thymus-derived CD8-positive, alpha-beta T cell': 1, 'common myeloid progenitor': 1, 'mononuclear phagocyte': 1, 'microglial cell': 1, 'platelet': 1, 'thymocyte': 1, 'hematopoietic precursor cell': 1, 'activated CD4-positive, alpha-beta T cell': 1, 'basophil': 1, 'tissue-resident macrophage': 1, 'mature NK T cell': 1, 'CD4-positive, alpha-beta thymocyte': 1, 'erythroid progenitor cell': 1, 'hematopoietic stem cell': 1, 'regulatory T cell': 1, 'non-classical monocyte': 1, 'myeloid leukocyte': 1, 'granulocyte': 1, 'myeloid dendritic cell': 1, 'innate lymphoid cell': 1, 'plasmacytoid dendritic cell': 1, 'colon macrophage': 1, 'hematopoietic cell': 1, 'leukocyte': 1, 'CD8-positive, alpha-beta thymocyte': 1, 'activated CD8-positive, alpha-beta T cell': 1, 'myeloid cell': 1, 'intermediate monocyte': 1, 'Langerhans cell': 1}
    Valid cells with >10 tokens: 200
    Extracting attention from layer 13...
    Evaluating AUROC with bootstrap...
    AUROC: 0.5838 [0.5389, 0.6212] (161 pos edges)
  Summary for 200 cells:
    Mean AUROC: 0.5924 ± 0.0085
    Mean CI: [0.5504, 0.6336]

--- Testing 300 cells ---
  Repeat 1/2...
    Sampled 300 cells
    Cell types: {'B cell': 55, 'CD8-positive, alpha-beta T cell': 38, 'erythrocyte': 7, 'plasma cell': 12, 'monocyte': 13, 'natural killer cell': 7, 'neutrophil': 35, 'myeloid cell': 1, 'CD4-positive, alpha-beta T cell': 48, 'macrophage': 33, 'mast cell': 3, 'T cell': 3, 'basophil': 1, 'innate lymphoid cell': 1, 'mature NK T cell': 2, 'classical monocyte': 9, 'gamma-delta T cell': 1, 'granulocyte': 1, 'activated CD4-positive, alpha-beta T cell': 1, 'leukocyte': 1, 'CD4-positive, alpha-beta thymocyte': 2, 'erythroid progenitor cell': 1, 'Langerhans cell': 1, 'naive thymus-derived CD8-positive, alpha-beta T cell': 1, 'CD8-positive, alpha-beta thymocyte': 1, 'colon macrophage': 1, 'mononuclear phagocyte': 2, 'hematopoietic stem cell': 1, 'naive thymus-derived CD4-positive, alpha-beta T cell': 4, 'hematopoietic precursor cell': 1, 'regulatory T cell': 1, 'common myeloid progenitor': 1, 'tissue-resident macrophage': 1, 'plasmacytoid dendritic cell': 1, 'intermediate monocyte': 2, 'activated CD8-positive, alpha-beta T cell': 1, 'myeloid leukocyte': 1, 'microglial cell': 1, 'platelet': 1, 'thymocyte': 1, 'myeloid dendritic cell': 1, 'hematopoietic cell': 1}
    Valid cells with >10 tokens: 300
    Extracting attention from layer 13...
    Evaluating AUROC with bootstrap...
    AUROC: 0.6150 [0.5782, 0.6492] (161 pos edges)
  Repeat 2/2...
    Sampled 300 cells
    Cell types: {'CD8-positive, alpha-beta T cell': 36, 'B cell': 55, 'natural killer cell': 7, 'CD4-positive, alpha-beta T cell': 50, 'gamma-delta T cell': 1, 'Langerhans cell': 1, 'neutrophil': 36, 'macrophage': 34, 'monocyte': 11, 'myeloid dendritic cell': 1, 'plasma cell': 12, 'T cell': 3, 'classical monocyte': 9, 'activated CD4-positive, alpha-beta T cell': 1, 'naive thymus-derived CD4-positive, alpha-beta T cell': 4, 'hematopoietic cell': 1, 'erythrocyte': 7, 'intermediate monocyte': 2, 'microglial cell': 1, 'regulatory T cell': 1, 'CD4-positive, alpha-beta thymocyte': 2, 'tissue-resident macrophage': 1, 'leukocyte': 1, 'mature NK T cell': 2, 'plasmacytoid dendritic cell': 1, 'myeloid leukocyte': 1, 'innate lymphoid cell': 1, 'hematopoietic precursor cell': 1, 'mononuclear phagocyte': 2, 'mast cell': 3, 'hematopoietic stem cell': 1, 'thymocyte': 1, 'non-classical monocyte': 1, 'CD8-positive, alpha-beta thymocyte': 1, 'basophil': 1, 'activated CD8-positive, alpha-beta T cell': 1, 'myeloid cell': 1, 'naive thymus-derived CD8-positive, alpha-beta T cell': 1, 'colon macrophage': 1, 'platelet': 1, 'erythroid progenitor cell': 1, 'common myeloid progenitor': 1}
    Valid cells with >10 tokens: 300
    Extracting attention from layer 13...
    Evaluating AUROC with bootstrap...
    AUROC: 0.5722 [0.5345, 0.6304] (161 pos edges)
  Summary for 300 cells:
    Mean AUROC: 0.5936 ± 0.0214
    Mean CI: [0.5564, 0.6398]

--- Testing 500 cells ---
  Repeat 1/2...
    Sampled 500 cells
    Cell types: {'macrophage': 56, 'B cell': 94, 'CD8-positive, alpha-beta T cell': 63, 'CD4-positive, alpha-beta T cell': 84, 'neutrophil': 61, 'monocyte': 22, 'mononuclear phagocyte': 4, 'naive thymus-derived CD4-positive, alpha-beta T cell': 7, 'activated CD4-positive, alpha-beta T cell': 1, 'leukocyte': 1, 'natural killer cell': 11, 'regulatory T cell': 2, 'CD4-positive, alpha-beta thymocyte': 4, 'plasma cell': 21, 'intermediate monocyte': 4, 'erythrocyte': 12, 'hematopoietic stem cell': 1, 'classical monocyte': 15, 'mast cell': 5, 'platelet': 1, 'plasmacytoid dendritic cell': 1, 'basophil': 1, 'CD8-positive, alpha-beta thymocyte': 1, 'T cell': 5, 'common myeloid progenitor': 1, 'myeloid leukocyte': 1, 'erythroid progenitor cell': 1, 'hematopoietic cell': 1, 'hematopoietic precursor cell': 1, 'mature NK T cell': 4, 'Langerhans cell': 1, 'thymocyte': 1, 'gamma-delta T cell': 2, 'myeloid cell': 1, 'naive thymus-derived CD8-positive, alpha-beta T cell': 1, 'activated CD8-positive, alpha-beta T cell': 1, 'microglial cell': 1, 'innate lymphoid cell': 1, 'non-classical monocyte': 1, 'tissue-resident macrophage': 1, 'myeloid dendritic cell': 1, 'colon macrophage': 1, 'granulocyte': 1}
    Valid cells with >10 tokens: 500
    Extracting attention from layer 13...
    Evaluating AUROC with bootstrap...
    AUROC: 0.6027 [0.5532, 0.6607] (161 pos edges)
  Repeat 2/2...
    Sampled 500 cells
    Cell types: {'B cell': 93, 'naive thymus-derived CD4-positive, alpha-beta T cell': 7, 'CD8-positive, alpha-beta T cell': 63, 'monocyte': 22, 'CD8-positive, alpha-beta thymocyte': 1, 'neutrophil': 61, 'macrophage': 56, 'plasma cell': 21, 'CD4-positive, alpha-beta T cell': 84, 'classical monocyte': 16, 'natural killer cell': 11, 'microglial cell': 1, 'innate lymphoid cell': 1, 'erythrocyte': 12, 'T cell': 5, 'intermediate monocyte': 4, 'CD4-positive, alpha-beta thymocyte': 4, 'basophil': 1, 'granulocyte': 1, 'hematopoietic precursor cell': 1, 'erythroid progenitor cell': 1, 'mast cell': 5, 'gamma-delta T cell': 2, 'myeloid leukocyte': 1, 'hematopoietic cell': 1, 'naive thymus-derived CD8-positive, alpha-beta T cell': 1, 'mononuclear phagocyte': 4, 'regulatory T cell': 2, 'Langerhans cell': 1, 'leukocyte': 1, 'colon macrophage': 1, 'mature NK T cell': 4, 'common myeloid progenitor': 1, 'myeloid dendritic cell': 1, 'tissue-resident macrophage': 1, 'activated CD8-positive, alpha-beta T cell': 1, 'plasmacytoid dendritic cell': 1, 'non-classical monocyte': 1, 'thymocyte': 1, 'hematopoietic stem cell': 1, 'myeloid cell': 1, 'platelet': 1, 'activated CD4-positive, alpha-beta T cell': 1}
    Valid cells with >10 tokens: 500
    Extracting attention from layer 13...
    Evaluating AUROC with bootstrap...
    AUROC: 0.6118 [0.5654, 0.6593] (161 pos edges)
  Summary for 500 cells:
    Mean AUROC: 0.6072 ± 0.0046
    Mean CI: [0.5593, 0.6600]

--- Testing 750 cells ---
  Repeat 1/2...
    Sampled 750 cells
    Cell types: {'B cell': 141, 'CD4-positive, alpha-beta T cell': 126, 'CD4-positive, alpha-beta thymocyte': 6, 'CD8-positive, alpha-beta T cell': 95, 'CD8-positive, alpha-beta thymocyte': 1, 'Langerhans cell': 1, 'T cell': 8, 'activated CD4-positive, alpha-beta T cell': 1, 'activated CD8-positive, alpha-beta T cell': 1, 'basophil': 2, 'classical monocyte': 24, 'colon macrophage': 1, 'common myeloid progenitor': 1, 'erythrocyte': 19, 'erythroid progenitor cell': 1, 'gamma-delta T cell': 3, 'granulocyte': 1, 'hematopoietic cell': 1, 'hematopoietic precursor cell': 2, 'hematopoietic stem cell': 1, 'innate lymphoid cell': 1, 'intermediate monocyte': 7, 'leukocyte': 1, 'macrophage': 87, 'mast cell': 7, 'mature NK T cell': 6, 'microglial cell': 1, 'monocyte': 33, 'mononuclear phagocyte': 6, 'myeloid cell': 1, 'myeloid dendritic cell': 1, 'myeloid leukocyte': 1, 'naive thymus-derived CD4-positive, alpha-beta T cell': 11, 'naive thymus-derived CD8-positive, alpha-beta T cell': 1, 'natural killer cell': 17, 'neutrophil': 93, 'non-classical monocyte': 1, 'plasma cell': 32, 'plasmacytoid dendritic cell': 1, 'platelet': 1, 'regulatory T cell': 3, 'thymocyte': 1, 'tissue-resident macrophage': 1}
    Valid cells with >10 tokens: 750
    Extracting attention from layer 13...
    Evaluating AUROC with bootstrap...
    AUROC: 0.6172 [0.5724, 0.6641] (161 pos edges)
  Repeat 2/2...
    Sampled 750 cells
    Cell types: {'B cell': 141, 'CD4-positive, alpha-beta T cell': 126, 'CD4-positive, alpha-beta thymocyte': 6, 'CD8-positive, alpha-beta T cell': 96, 'CD8-positive, alpha-beta thymocyte': 1, 'Langerhans cell': 1, 'T cell': 8, 'activated CD4-positive, alpha-beta T cell': 1, 'activated CD8-positive, alpha-beta T cell': 1, 'basophil': 2, 'classical monocyte': 24, 'colon macrophage': 1, 'common myeloid progenitor': 1, 'erythrocyte': 18, 'erythroid progenitor cell': 1, 'gamma-delta T cell': 3, 'granulocyte': 1, 'hematopoietic cell': 1, 'hematopoietic precursor cell': 2, 'hematopoietic stem cell': 1, 'innate lymphoid cell': 1, 'intermediate monocyte': 8, 'leukocyte': 1, 'macrophage': 86, 'mast cell': 7, 'mature NK T cell': 6, 'microglial cell': 1, 'monocyte': 33, 'mononuclear phagocyte': 6, 'myeloid cell': 1, 'myeloid dendritic cell': 1, 'myeloid leukocyte': 1, 'naive thymus-derived CD4-positive, alpha-beta T cell': 11, 'naive thymus-derived CD8-positive, alpha-beta T cell': 1, 'natural killer cell': 17, 'neutrophil': 93, 'non-classical monocyte': 1, 'plasma cell': 32, 'plasmacytoid dendritic cell': 1, 'platelet': 1, 'regulatory T cell': 3, 'thymocyte': 1, 'tissue-resident macrophage': 1}
    Valid cells with >10 tokens: 750
    Extracting attention from layer 13...
    Evaluating AUROC with bootstrap...
    AUROC: 0.6040 [0.5545, 0.6460] (161 pos edges)
  Summary for 750 cells:
    Mean AUROC: 0.6106 ± 0.0066
    Mean CI: [0.5635, 0.6551]

--- Testing 1000 cells ---
  Repeat 1/2...
    Sampled 1000 cells
    Cell types: {'B cell': 190, 'CD4-positive, alpha-beta T cell': 169, 'CD4-positive, alpha-beta thymocyte': 8, 'CD8-positive, alpha-beta T cell': 129, 'CD8-positive, alpha-beta thymocyte': 1, 'Langerhans cell': 1, 'T cell': 10, 'activated CD4-positive, alpha-beta T cell': 1, 'activated CD8-positive, alpha-beta T cell': 1, 'basophil': 2, 'classical monocyte': 32, 'colon macrophage': 1, 'common myeloid progenitor': 1, 'erythrocyte': 26, 'erythroid progenitor cell': 1, 'gamma-delta T cell': 4, 'granulocyte': 1, 'hematopoietic cell': 1, 'hematopoietic precursor cell': 3, 'hematopoietic stem cell': 1, 'innate lymphoid cell': 1, 'intermediate monocyte': 9, 'leukocyte': 1, 'macrophage': 113, 'mast cell': 10, 'mature NK T cell': 9, 'microglial cell': 1, 'monocyte': 44, 'mononuclear phagocyte': 9, 'myeloid cell': 1, 'myeloid dendritic cell': 1, 'myeloid leukocyte': 1, 'naive thymus-derived CD4-positive, alpha-beta T cell': 15, 'naive thymus-derived CD8-positive, alpha-beta T cell': 2, 'natural killer cell': 23, 'neutrophil': 122, 'non-classical monocyte': 2, 'plasma cell': 43, 'plasmacytoid dendritic cell': 1, 'platelet': 1, 'regulatory T cell': 5, 'thymocyte': 1, 'tissue-resident macrophage': 2}
    Valid cells with >10 tokens: 1000
    Extracting attention from layer 13...
    Evaluating AUROC with bootstrap...
    AUROC: 0.5933 [0.5378, 0.6331] (161 pos edges)
  Repeat 2/2...
    Sampled 1000 cells
    Cell types: {'B cell': 190, 'CD4-positive, alpha-beta T cell': 169, 'CD4-positive, alpha-beta thymocyte': 8, 'CD8-positive, alpha-beta T cell': 127, 'CD8-positive, alpha-beta thymocyte': 1, 'Langerhans cell': 1, 'T cell': 10, 'activated CD4-positive, alpha-beta T cell': 1, 'activated CD8-positive, alpha-beta T cell': 1, 'basophil': 2, 'classical monocyte': 32, 'colon macrophage': 1, 'common myeloid progenitor': 1, 'erythrocyte': 25, 'erythroid progenitor cell': 1, 'gamma-delta T cell': 4, 'granulocyte': 1, 'hematopoietic cell': 1, 'hematopoietic precursor cell': 3, 'hematopoietic stem cell': 1, 'innate lymphoid cell': 1, 'intermediate monocyte': 9, 'leukocyte': 1, 'macrophage': 114, 'mast cell': 10, 'mature NK T cell': 9, 'microglial cell': 1, 'monocyte': 44, 'mononuclear phagocyte': 9, 'myeloid cell': 1, 'myeloid dendritic cell': 1, 'myeloid leukocyte': 2, 'naive thymus-derived CD4-positive, alpha-beta T cell': 15, 'naive thymus-derived CD8-positive, alpha-beta T cell': 2, 'natural killer cell': 23, 'neutrophil': 123, 'non-classical monocyte': 2, 'plasma cell': 43, 'plasmacytoid dendritic cell': 1, 'platelet': 1, 'regulatory T cell': 5, 'thymocyte': 1, 'tissue-resident macrophage': 2}
    Valid cells with >10 tokens: 1000
    Extracting attention from layer 13...
    Evaluating AUROC with bootstrap...
    AUROC: 0.5988 [0.5403, 0.6447] (161 pos edges)
  Summary for 1000 cells:
    Mean AUROC: 0.5960 ± 0.0028
    Mean CI: [0.5391, 0.6389]

==================================================
CURVE FITTING ANALYSIS
==================================================
Fitting curves to 9 data points
Cell counts: [25, 50, 100, 150, 200, 300, 500, 750, 1000]
AUROCs: ['0.5359', '0.5419', '0.5445', '0.5557', '0.5924', '0.5936', '0.6072', '0.6106', '0.5960']
Power fit failed: Optimal parameters not found: Number of calls to function has reached maxfev = 2000.

LINEAR MODEL:
  R² = 0.5910
  Equation: AUROC = 0.000068 * cells + 0.551970

LOGARITHMIC MODEL:
  R² = 0.8313
  Equation: AUROC = 0.022388 * log(cells) + 0.457171

EXPONENTIAL_SATURATION MODEL:
  R² = 0.8998
  Equation: AUROC = 0.088848 * (1 - exp(-0.005535 * cells)) + 0.518478

Best fitting model: exponential_saturation (R² = 0.8998)

==================================================
SCALING PATTERN ANALYSIS
==================================================
Performance differences between consecutive points: ['0.0061', '0.0025', '0.0112', '0.0367', '0.0012', '0.0136', '0.0034', '-0.0146']
Relative changes: ['0.0113', '0.0047', '0.0206', '0.0660', '0.0021', '0.0230', '0.0055', '-0.0238']
Difference consistency (lower = more linear): 1.2161
Change trend (negative = decreasing rate): -0.003557

Degradation pattern assessment: logarithmic

============================================================
EXPERIMENT COMPLETED
============================================================
Results saved to: /mnt/d/openclaw/biodyn-nmi-paper/experiments/scaling_characterization/scaling_characterization_results.json
